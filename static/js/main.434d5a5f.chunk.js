(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{61:function(e,t,n){},62:function(e,t,n){},67:function(e,t,n){},68:function(e,t,n){},70:function(e,t,n){},71:function(e,t,n){},72:function(e,t,n){},73:function(e,t,n){},74:function(e,t,n){},75:function(e,t,n){},76:function(e,t,n){},78:function(e,t,n){},79:function(e,t,n){"use strict";n.r(t);var i=n(0),c=n.n(i),o=n(12),r=n.n(o),a=(n(61),n(14)),s=n(28),l=n(9),d=(n(62),n(101)),u=c.a.createContext({token:"",userId:"",login:function(){},logout:function(){}}),j=n(2),b=function(){var e=Object({NODE_ENV:"production",PUBLIC_URL:"/Booking_Frontend",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).REACT_APP_TEST_URL||"https://bookingbackendlucwag.herokuapp.com/graphql",t=Object(i.useState)(!1),n=Object(a.a)(t,2),o=n[0],r=n[1],s=c.a.useRef(null),l=c.a.useRef(null),b=Object(i.useContext)(u);return Object(j.jsxs)("form",{className:"auth-form",onSubmit:function(t){t.preventDefault();var n=s.current.value,i=l.current.value;if(console.log(n,i),console.log(b),0!==n.trim().length&&0!==i.trim().length){var c={query:"\n        query Login($email: String!, $password: String!){\n          login(email: $email, password: $password) {\n            userId\n            token\n            tokenExpiration\n          }\n        }\n      ",variables:{email:n,password:i}};o||(c={query:"\n          mutation CreateUser($email: String!, $password: String!){\n            createUser(userInput: {email: $email, password: $password}) {\n              _id\n              email\n            }\n          }\n        ",variables:{email:n,password:i}}),fetch(e,{method:"POST",body:JSON.stringify(c),headers:{"Content-Type":"application/json"}}).then((function(e){if(200!==e.status&&201!==e.status)throw new Error("Fetch Failed");return e.json()})).then((function(e){console.log(e),e.data.login.token&&b.login(e.data.login.token,e.data.login.userId,e.data.login.tokenExpiration)})).catch((function(e){console.log(e)}))}},children:[Object(j.jsxs)("div",{className:"form-control",children:[Object(j.jsx)("label",{htmlFor:"email",children:"Email"}),Object(j.jsx)("input",{type:"email",id:"email",ref:s})]}),Object(j.jsxs)("div",{className:"form-control",children:[Object(j.jsx)("label",{htmlFor:"password",children:"Password"}),Object(j.jsx)("input",{type:"password",id:"password",ref:l})]}),Object(j.jsxs)("div",{className:"form-action",children:[Object(j.jsx)(d.a,{variant:"contained",color:"primary",type:"submit",children:"Submit"}),Object(j.jsxs)(d.a,{variant:"contained",color:"primary",type:"button",onClick:function(){r((function(e){return!e}))},children:["Switch to ",o?"Signup":"Login"]})]})]})},h=n(102),O=(n(67),function(){return Object(j.jsx)("div",{className:"spinner",children:Object(j.jsx)(h.a,{})})}),f=(n(68),function(e){return Object(j.jsx)("ul",{className:"bookings__list",children:e.bookings.map((function(t){return Object(j.jsxs)("li",{className:"bookings__item",children:[Object(j.jsxs)("div",{className:"bookings__item-data",children:[t.event.title," -"," ",new Date(t.createdAt).toLocaleDateString()]}),Object(j.jsx)("div",{className:"bookings__item-actions",children:Object(j.jsx)(d.a,{variant:"contained",color:"primary",type:"submit",className:"btn",onClick:function(){return e.onDelete(t._id)},children:"Cancel"})})]},t._id)}))})}),m=n(103),p=n(29),x=n(8),v=function(e){var t=[{priceRange:"low",anz:e.bookings.reduce((function(e,t){return t.event.price<2?e+1:e}),0)},{priceRange:"medium",anz:e.bookings.reduce((function(e,t){return(2<t.event.price&&t.event.price<5)<5?e+1:e}),0)},{priceRange:"high",anz:e.bookings.reduce((function(e,t){return 5<t.event.price&&t.event.price<10?e+1:e}),0)}];return Object(j.jsx)(m.a,{children:Object(j.jsxs)(p.c,{data:t,children:[Object(j.jsx)(p.a,{}),Object(j.jsx)(p.e,{max:7}),Object(j.jsx)(p.b,{valueField:"anz",argumentField:"priceRange",color:"rgba(78, 0, 129, 0.5)"}),Object(j.jsx)(p.d,{text:"Bookings"}),Object(j.jsx)(x.a,{})]})})},g=(n(70),function(){var e=Object({NODE_ENV:"production",PUBLIC_URL:"/Booking_Frontend",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).REACT_APP_TEST_URL||"https://bookingbackendlucwag.herokuapp.com/graphql",t=Object(i.useState)(!1),n=Object(a.a)(t,2),o=n[0],r=n[1],s=Object(i.useState)([]),l=Object(a.a)(s,2),b=l[0],h=l[1],m=Object(i.useState)(!0),p=Object(a.a)(m,2),x=p[0],g=p[1],_=Object(i.useContext)(u);Object(i.useEffect)((function(){k()}),[]);var k=function(){if(_.token){r(!0);fetch(e,{method:"POST",body:JSON.stringify({query:"\n        query {\n          bookings {\n            _id\n            createdAt\n            updatedAt\n            event {\n              _id\n              title\n              date\n              price\n            }\n            \n          }\n        }\n      "}),headers:{"Content-Type":"application/json",Authorization:"Bearer "+_.token}}).then((function(e){if(200!==e.status&&201!==e.status)throw new Error("Fetch Failed");return e.json()})).then((function(e){var t=e.data.bookings;h(t),r(!1)})).catch((function(e){console.log(e),r(!1)}))}else h(null)};return Object(j.jsx)(c.a.Fragment,{children:o?Object(j.jsx)(O,{}):Object(j.jsxs)(c.a.Fragment,{children:[Object(j.jsxs)("div",{className:"switchButtons",children:[Object(j.jsx)(d.a,{disabled:x,variant:"contained",color:"primary",type:"submit",className:"switchBtn",onClick:function(){return g(!0)},children:"List"}),Object(j.jsx)(d.a,{disabled:!x,variant:"contained",color:"primary",type:"submit",className:"switchBtn",onClick:function(){return g(!1)},children:"Chart"})]}),x?Object(j.jsx)(f,{bookings:b,onDelete:function(t){if(_.token){r(!0);var n={query:"\n        mutation CancelBooking($bookingId: ID!) {\n          cancelBooking(bookingId: $bookingId) {\n            _id\n            title\n          }\n        }\n      ",variables:{bookingId:t}};fetch(e,{method:"POST",body:JSON.stringify(n),headers:{"Content-Type":"application/json",Authorization:"Bearer "+_.token}}).then((function(e){if(200!==e.status&&201!==e.status)throw new Error("Fetch Failed");return e.json()})).then((function(e){h((function(e){return e.filter((function(e){return e._id!==t}))})),r(!1)})).catch((function(e){console.log(e),r(!1)}))}}}):Object(j.jsx)(v,{bookings:b})]})})}),_=n(49),k=(n(71),function(e){return Object(j.jsxs)("div",{className:"modal",children:[Object(j.jsx)("header",{className:"modal__header",children:Object(j.jsx)("h1",{children:e.title})}),Object(j.jsx)("section",{className:"modal__content",children:e.children}),Object(j.jsxs)("section",{className:"modal__actions",children:[e.canCancel&&Object(j.jsx)(d.a,{variant:"contained",color:"primary",type:"submit",className:"btn",onClick:function(){e.onCancel()},children:"Cancel"}),e.canConfirm&&Object(j.jsx)(d.a,{variant:"contained",color:"primary",type:"submit",className:"btn",onClick:function(){e.onConfirm()},children:e.confirmText})]})]})}),S=(n(72),function(e){return Object(j.jsx)("div",{className:"backdrop"})}),C=(n(73),n(74),n(75),function(e){return Object(j.jsxs)("li",{className:"event__list-item",children:[Object(j.jsxs)("div",{children:[Object(j.jsx)("h1",{children:e.title}),Object(j.jsxs)("h2",{children:[e.price,"$"]}),Object(j.jsx)("h2",{children:new Date(e.date).toLocaleDateString("de")})]}),Object(j.jsx)("div",{children:e.userId!==e.creatorId?Object(j.jsx)(d.a,{variant:"contained",color:"primary",type:"submit",className:"btn",onClick:function(){return e.onDetail(e.eventId)},children:"View Details"}):Object(j.jsx)("p",{children:"You are the Owner"})})]},e._id)}),y=function(e){var t=e.events.map((function(t){return Object(j.jsx)(C,{eventId:t._id,title:t.title,price:t.price,date:t.date,userId:e.authUserId,creatorId:t.creator._id,onDetail:e.onViewDetail},t._id)}));return Object(j.jsx)("ul",{className:"event__list",children:t})},E=function(){var e=Object({NODE_ENV:"production",PUBLIC_URL:"/Booking_Frontend",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).REACT_APP_TEST_URL||"https://bookingbackendlucwag.herokuapp.com/graphql",t=Object(i.useRef)(null),n=Object(i.useRef)(null),o=Object(i.useRef)(null),r=Object(i.useRef)(null),s=Object(i.useState)(!1),l=Object(a.a)(s,2),b=l[0],h=l[1],f=Object(i.useState)([]),m=Object(a.a)(f,2),p=m[0],x=m[1],v=Object(i.useState)(!1),g=Object(a.a)(v,2),C=g[0],E=g[1],T=Object(i.useState)(null),N=Object(a.a)(T,2),w=N[0],F=N[1],D=Object(i.useContext)(u);Object(i.useEffect)((function(){E(!0);fetch(e,{method:"POST",body:JSON.stringify({query:"\n        query {\n          events {\n            _id\n            title\n            description\n            date\n            price\n            creator {\n              _id\n              email\n            }\n          }\n        }\n      "}),headers:{"Content-Type":"application/json"}}).then((function(e){if(200!==e.status&&201!==e.status)throw new Error("Fetch Failed");return e.json()})).then((function(e){x(e.data.events),E(!1)})).catch((function(e){console.log(e),E(!1)}))}),[]);var I=function(){h(!1),F(null)};return Object(j.jsxs)(c.a.Fragment,{children:[D.token&&Object(j.jsxs)("div",{className:"events-control",children:[Object(j.jsx)("p",{children:"Share your own Events!"}),Object(j.jsx)(d.a,{variant:"contained",color:"primary",type:"submit",onClick:function(){return h(!0)},children:"Create Event"})]}),C?Object(j.jsx)(O,{}):Object(j.jsx)(y,{events:p,authUserId:D.userId,onViewDetail:function(e){F(p.find((function(t){return t._id===e})))}}),(b||w)&&Object(j.jsx)(S,{}),b&&Object(j.jsx)(k,{title:"Add Event",canCancel:!0,canConfirm:!0,onCancel:function(){I()},onConfirm:function(){!function(){var i=t.current.value,c=+n.current.value,a=o.current.value,s=r.current.value;if(!(0===i.trim().length||c<=0||0===a.trim().length||0===s.trim().length)){var l={title:i,price:c,date:a,description:s};console.log(l),h(!1);var d={query:"\n        mutation CreateEvent($title: String!, $description: String!, $price: Float!, $date: String!){\n          createEvent(eventInput: {title: $title, description: $description, price: $price, date: $date}) {\n            _id\n            title\n            description\n            date\n            price\n          }\n        }\n      ",variables:{title:i,description:s,price:c,date:a}};fetch(e,{method:"POST",body:JSON.stringify(d),headers:{"Content-Type":"application/json",Authorization:"Bearer "+D.token}}).then((function(e){if(200!==e.status&&201!==e.status)throw new Error("Fetch Failed");return e.json()})).then((function(e){console.log(e),x((function(t){return[].concat(Object(_.a)(t),[{_id:e.data.createEvent._id,title:e.data.createEvent.title,description:e.data.createEvent.description,date:e.data.createEvent.date,price:e.data.createEvent.price,creator:{_id:D.userId}}])}))})).catch((function(e){console.log(e)}))}}()},confirmText:"Confirm",children:Object(j.jsxs)("form",{children:[Object(j.jsxs)("div",{className:"form-control",children:[Object(j.jsx)("label",{htmlFor:"title",children:"Title"}),Object(j.jsx)("input",{type:"text",id:"title",ref:t})]}),Object(j.jsxs)("div",{className:"form-control",children:[Object(j.jsx)("label",{htmlFor:"price",children:"Price"}),Object(j.jsx)("input",{type:"number",id:"price",ref:n})]}),Object(j.jsxs)("div",{className:"form-control",children:[Object(j.jsx)("label",{htmlFor:"date",children:"Date"}),Object(j.jsx)("input",{type:"datetime-local",id:"date",ref:o})]}),Object(j.jsxs)("div",{className:"form-control",children:[Object(j.jsx)("label",{htmlFor:"description",children:"Description"}),Object(j.jsx)("textarea",{id:"description",row:"4",ref:r})]})]})}),w&&Object(j.jsxs)(k,{title:w.title,canCancel:!0,canConfirm:!0,onCancel:function(){I()},onConfirm:function(){!function(){if(D.token){var t={query:"\n        mutation BookEvent($eventId: ID!){\n          bookEvent(eventId: $eventId) {\n            _id\n            createdAt\n            updatedAt\n          }\n        }\n      ",variables:{eventId:w._id}};fetch(e,{method:"POST",body:JSON.stringify(t),headers:{"Content-Type":"application/json",Authorization:"Bearer "+D.token}}).then((function(e){if(200!==e.status&&201!==e.status)throw new Error("Fetch Failed");return e.json()})).then((function(e){console.log(e),F(null)})).catch((function(e){console.log(e),F(null)}))}else F(null)}()},confirmText:D.token?"Book":"Sign in to book",children:[Object(j.jsxs)("h1",{children:["Eventname: ",w.title]}),Object(j.jsxs)("h2",{children:[w.price,"$"]}),Object(j.jsx)("h2",{children:new Date(w.date).toLocaleDateString()}),Object(j.jsx)("p",{children:w.description})]})]})},T=(n(76),function(){var e=Object(i.useContext)(u);return Object(j.jsxs)("header",{className:"main-navigation",children:[Object(j.jsx)("div",{className:"main-navigation__logo",children:Object(j.jsx)("h1",{children:"BookingApp"})}),Object(j.jsx)("nav",{className:"main-navigation__items",children:Object(j.jsxs)("ul",{children:[Object(j.jsx)("li",{children:Object(j.jsx)(s.b,{to:"/events",children:"Events"})}),e.token&&Object(j.jsxs)(c.a.Fragment,{children:[Object(j.jsx)("li",{children:Object(j.jsx)(s.b,{to:"/bookings",children:"Bookings"})}),Object(j.jsx)("li",{children:Object(j.jsx)("button",{onClick:function(){return e.logout()},className:"LogOutButton",children:"Logout"})})]}),!e.token&&Object(j.jsx)("li",{children:Object(j.jsx)(s.b,{to:"/auth",children:"Authentication"})})]})})]})});n(78);var N=function(){var e=Object(i.useState)(""),t=Object(a.a)(e,2),n=t[0],c=t[1],o=Object(i.useState)(""),r=Object(a.a)(o,2),d=r[0],h=r[1];return Object(j.jsx)(s.a,{children:Object(j.jsxs)(u.Provider,{value:{token:n,userId:d,login:function(e,t,n){c(e),h(t)},logout:function(){c(""),h("")}},children:[Object(j.jsx)(T,{}),Object(j.jsx)("main",{className:"main-content",children:Object(j.jsxs)(l.d,{children:[n&&Object(j.jsx)(l.a,{from:"/",to:"/events",exact:!0}),n&&Object(j.jsx)(l.a,{from:"/auth",to:"/events",exact:!0}),!n&&Object(j.jsx)(l.b,{path:"/auth",component:b}),Object(j.jsx)(l.b,{path:"/events",component:E}),n&&Object(j.jsx)(l.b,{path:"/bookings",component:g}),!n&&Object(j.jsx)(l.a,{to:"/auth",exact:!0})]})})]})})};r.a.render(Object(j.jsx)(c.a.StrictMode,{children:Object(j.jsx)(N,{})}),document.getElementById("root"))}},[[79,1,2]]]);
//# sourceMappingURL=main.434d5a5f.chunk.js.map